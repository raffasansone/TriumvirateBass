version: 2.1
executors:
  my-custom-executor:
    docker:
      - image: cimg/base:stable
        auth:
          # ensure you have first added these secrets
          # visit app.circleci.com/settings/project/github/raffasansone/TriumvirateBass/environment-variables
          username: $DOCKER_HUB_USER
          password: $DOCKER_HUB_PASSWORD
jobs:
  macos-build:
    macos:
      xcode: 13.4.1
       
    steps:
      - checkout
      - run: 
            name: Sync submodules
            command: 
                git submodule sync --recursive 
                git submodule update --init --recursive
                ls ff_meters
                ls JUCE
      - run: 
            name: XCode Build 
            command: xcodebuild -project Builds/MacOSX/TriumvirateBass.xcodeproj -alltargets -parallelizeTargets -configuration Release build

workflows:
  my-custom-workflow:
    jobs:
      - macos-build